<UserControl
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d" d:DesignWidth="1080" d:DesignHeight="720"
    xmlns:vm="clr-namespace:GottaManagePlus.ViewModels"
    xmlns:models="using:GottaManagePlus.Models"
    xmlns:local="using:GottaManagePlus.Styles"
    x:Class="GottaManagePlus.Views.MyModsView"
    x:DataType="vm:MyModsViewModel"
    >
    <Design.DataContext>
        <vm:MyModsViewModel/>
    </Design.DataContext>
    <Design.DesignStyle>
        <StyleInclude Source="/Styles/style.axaml"/>
    </Design.DesignStyle>
    
    <UserControl.Resources>
        <ResourceDictionary>
            <LinearGradientBrush
                x:Key="YctpBg"
                StartPoint="0% 100%"
                EndPoint="0% 0%">
                    <LinearGradientBrush.GradientStops>
                        <GradientStop Color="#118500" Offset="0.0" />
                        <GradientStop Color="#12FF00" Offset="0.5" />
                    </LinearGradientBrush.GradientStops>
                </LinearGradientBrush>
            </ResourceDictionary>
    </UserControl.Resources>
    
    <UserControl.Styles>
        <StyleInclude Source="/Styles/style.axaml"/>
        <!--MOD VIEWER STYLING-->
        <Style Selector=":is(Control).ModViewerHeader">
            <Setter Property="VerticalAlignment" Value="{Binding $parent[StackPanel].VerticalAlignment}" />
        </Style>
        <!--MOD NAME STYLING-->
        <Style Selector=":is(TextBlock).ModLabel" x:DataType="models:ModItem">
            <Setter Property="HorizontalAlignment" Value="Left" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="FontFamily" Value="{StaticResource ComicRelief}" />
            <Setter Property="TextAlignment" Value="Center" />
            <Setter Property="Foreground" Value="White" />
        </Style>
        <Style Selector="local|OutlinedTextBlock.ModLabel">
            <Setter Property="OutlineColor" Value="Black"/>
            <Setter Property="OutlineWidth" Value="1.5"/>
        </Style>
    </UserControl.Styles>

    <!-- Content Below -->
    <!-- START of Mod List-->
    <Border
    ClipToBounds="True"
    Classes="Menu_Border BorderDropShadow AllCornerRadius"
    Margin="25 0 10 10"
    >
        <Grid RowDefinitions="Auto, *">
            <Border Grid.Row="0" 
                    HorizontalAlignment="Stretch" 
                    VerticalAlignment="Stretch"
                    Classes="Menu_Header">
                <Border.Background>
                    <ImageBrush
                        Source="/Assets/UI/Icon_ModsBg.png"
                        TileMode="Tile"
                        Stretch="None"
                        DestinationRect="-32 34 64 64"
                        Opacity="0.175"
                        />
                </Border.Background>
            </Border> 
            <!-- Mod Header -->
            <Grid Grid.Row="0" 
                  Margin="0 5" 
                  ColumnDefinitions="Auto, *">
                <Panel Grid.Column="0"> <!-- Stack TextBlocks together -->
                    <!--TEMP COMMENT: USE LANGUAGE HERE-->
                    <TextBlock 
                        Text="Installed Mods" 
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Foreground="White"
                        FontWeight="UltraBold"
                        Classes="SideMenu-Label RightHeader GlowShadow"/>
                    <TextBlock 
                        Text="Installed Mods" 
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Classes="SideMenu-Label RightHeader"/>
                </Panel>
                <StackPanel
                    Grid.Column="1"
                    HorizontalAlignment="Right"
                    Margin="10 0"
                    VerticalAlignment="Center"
                    Orientation="Horizontal">
                    <!--TEMP COMMENT: USE LANGUAGE HERE-->
                    <!--Scroll viewer search box-->
                    <Button 
                        Margin="10 0"
                        Classes="ModViewerHeader YCTPButton">
                        <Image
                            Source="/Assets/UI/Icon_AddModContainer.png"
                            Width="32"
                            Height="32"
                        />
                    </Button>
                    <AutoCompleteBox
                        Classes="ModViewerHeader"
                        Width="250"
                        Watermark="Search"
                        ItemsSource="{Binding ObservableUnchangedMods}"
                        SelectedItem="{Binding CurrentModItem}"
                        Text="{Binding Text}"
                        ValueMemberBinding="{Binding ModName, DataType=models:ModItem}"
                        FilterMode="Contains"
                    />
                    <Button 
                        Classes="ModViewerHeader YCTPButton"
                        Margin="5 0 0 0"
                        Command="{CompiledBinding ResetSearch}">
                        <Image
                            Source="/Assets/UI/Icon_Cancel_Generic.png"
                            Width="32"
                            Height="32"
                        />
                    </Button>
                </StackPanel>
            </Grid>
            
            <!-- Actual Mod Scroll Viewer -->
            <ScrollViewer 
            Grid.Row="1"
            Background="{DynamicResource ModsListBg}">

            <ItemsControl
                ItemsSource="{Binding ObservableMods}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate DataType="{x:Type models:ModItem}">
                            <Panel>
                                <!--Background for the shade effect-->
                                <Border Margin="5 0 5 5"
                                        CornerRadius="35"
                                        ClipToBounds="True"
                                        BorderThickness="5"
                                        BoxShadow="inset 50 -25 125 0 Black"
                                        BorderBrush="{DynamicResource YctpBg}">
                                    <Border.Background>
                                        <ImageBrush Source="/Assets/UI/ModList_Header.png"
                                                    Stretch="UniformToFill"
                                                    AlignmentX="Center"
                                                    AlignmentY="Center"/>
                                    </Border.Background>
                                </Border>
                                
                                <Grid ColumnDefinitions="*, Auto" 
                                      HorizontalAlignment="Stretch" 
                                      VerticalAlignment="Stretch"
                                      Margin="30">
                                    <!--<Border
                                        Classes="YCTP">
                                        <Border
                                            HorizontalAlignment="{Binding $parent.HorizontalAlignment}"
                                            VerticalAlignment="{Binding $parent.VerticalAlignment}"
                                            CornerRadius="{Binding $parent.CornerRadius}"
                                            Margin="5"
                                            Background="Black">
                                        </Border>
                                    </Border>-->
                                    <!--Mod Name Layout-->
                                    <Panel Grid.Column="0">
                                        <StackPanel Margin="15 10" Orientation="Vertical">
                                            <local:OutlinedTextBlock
                                                Text="{Binding ModName}"
                                                FontSize="32"
                                                TextTrimming="CharacterEllipsis"
                                                Classes="ModLabel"/>
                                            <local:OutlinedTextBlock 
                                                Text="{Binding ModVersion}"
                                                FontSize="20"
                                                HorizontalAlignment="Left"
                                                OutlineWidth="0.65"
                                                Classes="ModLabel"/>
                                        </StackPanel>
                                    </Panel>
                                    <!--Mod Buttons/Options-->
                                    <StackPanel Grid.Column="1" 
                                                Orientation="Horizontal"
                                                HorizontalAlignment="Right"
                                                Spacing="10">
                                        <!-- Open Folder Button -->
                                        <Button Classes="YCTPButton">
                                            <Image Source="/Assets/UI/Icon_OpenModFolder.png"/>
                                        </Button>
                                        <!-- Update Button -->
                                        <Button Classes="YCTPButton">
                                            <Image Source="/Assets/UI/Icon_UpdateMod.png"/>
                                        </Button>
                                        <!-- Delete Button -->
                                        <Button
                                            Classes="YCTPButton"
                                            Command="{CompiledBinding ((vm:MyModsViewModel)DataContext).DeleteModItem, RelativeSource={RelativeSource FindAncestor, AncestorType=ItemsControl}}"
                                            CommandParameter="{Binding Id}">
                                            <Image Source="/Assets/UI/Icon_DeleteMod.png"/>
                                        </Button>
                                    </StackPanel>
                                </Grid>
                            </Panel>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
        </Grid>
    </Border>
    <!-- END of Mod List -->

</UserControl>