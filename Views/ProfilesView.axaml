<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:models="using:GottaManagePlus.Models"
             xmlns:vm="clr-namespace:GottaManagePlus.ViewModels"
             mc:Ignorable="d" d:DesignWidth="200" d:DesignHeight="650"
             x:Class="GottaManagePlus.Views.ProfilesView"
             x:DataType="vm:ProfilesViewModel">
    
    <Design.DataContext>
        <vm:ProfilesViewModel/>
    </Design.DataContext>
    <Design.DesignStyle>
        <StyleInclude Source="/Styles/style.axaml"/>
    </Design.DesignStyle>
    
    <UserControl.Styles>
        <StyleInclude Source="/Styles/style.axaml"/>
        
        <Style Selector=":is(Control).ModViewerHeader">
            <Setter Property="VerticalAlignment" Value="{Binding $parent[StackPanel].VerticalAlignment}" />
        </Style>
        
        <!-- YCTP Override -->
        <Style Selector="Button.YCTPButton">
            <Setter Property="Background">
                <Setter.Value>
                    <ImageBrush
                        Source="/Assets/UI/Button_Normal_32x32.png"
                        Stretch="Uniform"
                    />
                </Setter.Value>
            </Setter>
            <Style Selector="^ Image">
                <Setter Property="Margin" Value="5"/>
                <Setter Property="MaxWidth" Value="16"/>
                <Setter Property="MaxHeight" Value="16"/>
            </Style>
            <!--Pointer over style consistency-->
            <Style Selector="^:pointerover /template/ ContentPresenter#PART_ContentPresenter">
                <Setter Property="Background">
                    <Setter.Value>
                        <ImageBrush
                            Source="/Assets/UI/Button_Normal_Selected_32x32.png"
                            Stretch="Uniform"
                        />
                    </Setter.Value>
                </Setter>
            </Style>
        </Style>
        
        <!-- Styled Labels -->
        <Style Selector="TextBlock.ProfileLabel">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontFamily" Value="{DynamicResource ComicRelief}"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>
    </UserControl.Styles>
    
    <!-- START of Profiles -->
    <Border
    ClipToBounds="True"
    Classes="Menu_Border BorderDropShadow AllCornerRadius"
    Margin="25 0 10 10">
        <Grid RowDefinitions="Auto, *">
            <Border Grid.Row="0" 
                    HorizontalAlignment="Stretch" 
                    VerticalAlignment="Stretch"
                    Classes="Menu_Header">
                <Border.Background>
                    <ImageBrush
                        Source="/Assets/UI/Icon_ModsBg.png"
                        TileMode="Tile"
                        Stretch="None"
                        DestinationRect="-32 34 64 64"
                        Opacity="0.175"
                        />
                </Border.Background>
            </Border> 
            <!-- Mod Header -->
            <StackPanel 
                Margin="0 0 0 5"
                Grid.Row="0"
                HorizontalAlignment="Center"
                Orientation="Vertical">
                <Panel> <!-- Stack TextBlocks together -->
                    <!--TEMP COMMENT: USE LANGUAGE HERE-->
                    <TextBlock 
                        Text="Profiles" 
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Foreground="White"
                        FontWeight="UltraBold"
                        Classes="SideMenu-Label RightHeader GlowShadow"/>
                    <TextBlock 
                        Text="Profiles" 
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Classes="SideMenu-Label RightHeader"/>
                </Panel>
                <StackPanel 
                    Margin="5 0"
                    VerticalAlignment="Center"
                    Orientation="Horizontal">
                    <AutoCompleteBox
                        Classes="ModViewerHeader"
                        Width="110"
                        Watermark="Search"
                        ItemsSource="{Binding ProfilesList}"
                        SelectedItem="{Binding CurrentProfileItem}"
                        Text="{Binding Text}"
                        ValueMemberBinding="{Binding ProfileName, DataType=models:ProfileItem}"
                        FilterMode="Contains"
                    />
                    <Button 
                        Classes="ModViewerHeader YCTPButton"
                        Margin="5 0 0 0"
                        Command="{CompiledBinding ResetSearch}">
                        <Image
                            Source="/Assets/UI/Icon_Cancel_Generic.png"
                            Width="24"
                            Height="24"
                        />
                    </Button>
                </StackPanel>
            </StackPanel>
            <!-- Actual Mod Scroll Viewer -->
            <ScrollViewer 
            Grid.Row="1"
            Background="{DynamicResource ProfilesBg}">

            <ItemsControl
                ItemsSource="{Binding ObservableProfiles}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate DataType="{x:Type models:ProfileItem}">
                            <Panel>
                                <!--Background for the shade effect-->
                                <Border
                                        CornerRadius="5"
                                        ClipToBounds="True"
                                        BorderThickness="5"
                                        BoxShadow="inset 50 -25 125 0 Black"
                                        Background="Gray"
                                        BorderBrush="{DynamicResource YctpBg}">
                                </Border>
                                
                                <Grid ColumnDefinitions="*, Auto" 
                                      HorizontalAlignment="Stretch" 
                                      VerticalAlignment="Stretch"
                                      Margin="0 5 5 5">
                                    <!--Mod Name Layout-->
                                    <Panel Grid.Column="0">
                                        <StackPanel Margin="15 10" Orientation="Vertical">
                                            <TextBlock
                                                Text="{Binding ProfileName}"
                                                Classes="ProfileLabel"
                                                TextTrimming="CharacterEllipsis"/>
                                        </StackPanel>
                                    </Panel>
                                    <!--Mod Buttons/Options-->
                                    <StackPanel Grid.Column="1" 
                                                Orientation="Horizontal"
                                                HorizontalAlignment="Right"
                                                Spacing="5">
                                        <!-- Info Button -->
                                        <Button
                                            Classes="YCTPButton"
                                            Command="{CompiledBinding ((vm:ProfilesViewModel)DataContext).OpenProfileMetadata, RelativeSource={RelativeSource FindAncestor, AncestorType=ItemsControl}}"
                                            CommandParameter="{Binding Id}">
                                            <Image Source="/Assets/UI/Icon_ProfilesBtn.png"/>
                                        </Button>
                                    </StackPanel>
                                </Grid>
                            </Panel>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
        </Grid>
    </Border>
    <!-- END of Profiles -->
    
</UserControl>
